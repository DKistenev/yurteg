"""Генерация 8 дополнительных тестовых документов для ЮрТэг v0.3.

Каждый документ покрывает новый тип из document_types_hints
и содержит намеренные аномалии для демонстрации валидации L1-L4.

Запуск: python tests/generate_test_docs.py
"""
from pathlib import Path
from docx import Document


OUTPUT_DIR = Path(__file__).parent / "test_data"


def _add_paragraph(doc: Document, text: str, bold: bool = False) -> None:
    p = doc.add_paragraph()
    run = p.add_run(text)
    run.bold = bold


def create_act() -> None:
    """Акт выполненных работ — эталонный документ без ошибок."""
    doc = Document()
    doc.add_heading("АКТ ВЫПОЛНЕННЫХ РАБОТ № 47", level=1)

    _add_paragraph(doc, "г. Москва                                                    20 января 2025 г.")
    _add_paragraph(doc, "")
    _add_paragraph(doc,
        'ООО "ПромСервис" (ИНН 7723456789, ОГРН 1157746012345), '
        "именуемое в дальнейшем «Исполнитель», в лице генерального директора "
        "Фёдорова Алексея Викторовича, действующего на основании Устава, с одной стороны, и"
    )
    _add_paragraph(doc,
        'АО "ГлобалТранс" (ИНН 7701234568, ОГРН 1037700132199), '
        "именуемое в дальнейшем «Заказчик», в лице директора "
        "Морозовой Ирины Сергеевны, действующей на основании Устава, с другой стороны,"
    )
    _add_paragraph(doc,
        "составили настоящий Акт о нижеследующем:"
    )
    _add_paragraph(doc, "")
    _add_paragraph(doc,
        "1. Исполнитель выполнил, а Заказчик принял работы по техническому обслуживанию "
        "серверного оборудования в соответствии с Договором оказания услуг № 128/2024 "
        "от 15 ноября 2024 г."
    )
    _add_paragraph(doc,
        "2. Стоимость выполненных работ составляет 450 000 (четыреста пятьдесят тысяч) "
        "рублей 00 копеек, НДС не облагается."
    )
    _add_paragraph(doc,
        "3. Работы выполнены в полном объёме и в установленные сроки. "
        "Заказчик претензий по объёму, качеству и срокам выполнения работ не имеет."
    )
    _add_paragraph(doc, "")
    _add_paragraph(doc, "Реквизиты сторон:", bold=True)
    _add_paragraph(doc,
        'Исполнитель: ООО "ПромСервис", р/с 40702810500000045678 '
        "в ПАО Сбербанк, БИК 044525225, к/с 30101810400000000225. "
        "Адрес: г. Москва, ул. Промышленная, д. 15, офис 401. "
        "Тел: +7 (495) 234-56-78, email: info@promservice.ru"
    )
    _add_paragraph(doc,
        'Заказчик: АО "ГлобалТранс", р/с 40702810700000098765 '
        "в АО Альфа-Банк, БИК 044525593, к/с 30101810200000000593. "
        "Адрес: г. Москва, Ленинградский пр., д. 80, стр. 2."
    )
    _add_paragraph(doc, "")
    _add_paragraph(doc, "Исполнитель: ________________ / Фёдоров А.В. /")
    _add_paragraph(doc, "Заказчик:    ________________ / Морозова И.С. /")

    doc.save(OUTPUT_DIR / "акт_выполненных_работ.docx")


def create_invoice_no_amount() -> None:
    """Счёт на оплату — АНОМАЛИЯ L1: нет суммы и предмета."""
    doc = Document()
    doc.add_heading("СЧЁТ НА ОПЛАТУ № 215", level=1)

    _add_paragraph(doc, "от 1 февраля 2025 г.")
    _add_paragraph(doc, "")
    _add_paragraph(doc,
        'Поставщик: ИП Козлов Андрей Владимирович (ИНН 772345678901, '
        "ОГРНИП 318774600012345). Адрес: г. Москва, ул. Садовая, д. 10, кв. 5."
    )
    _add_paragraph(doc,
        'Покупатель: ООО "ТехноЛайт" (ИНН 7709876541, ОГРН 1197746012345).'
    )
    _add_paragraph(doc, "")
    _add_paragraph(doc, "Просим оплатить по следующим реквизитам:")
    _add_paragraph(doc,
        "р/с 40802810100000056789 в ПАО ВТБ, БИК 044525187, "
        "к/с 30101810700000000187."
    )
    _add_paragraph(doc, "")
    _add_paragraph(doc,
        "Основание: в соответствии с условиями договора."
    )
    _add_paragraph(doc, "")
    _add_paragraph(doc, "ИП Козлов А.В. ________________")

    doc.save(OUTPUT_DIR / "счёт_без_суммы.docx")


def create_addendum_dates_reversed() -> None:
    """Дополнительное соглашение — АНОМАЛИЯ L2: start > end, дата 1998 г."""
    doc = Document()
    doc.add_heading("ДОПОЛНИТЕЛЬНОЕ СОГЛАШЕНИЕ № 3", level=1)
    _add_paragraph(doc, "к Договору подряда № 45/1998 от 15 марта 1998 г.")
    _add_paragraph(doc, "")
    _add_paragraph(doc, "г. Новосибирск                                                12 апреля 1998 г.")
    _add_paragraph(doc, "")
    _add_paragraph(doc,
        'ООО "ТехноСтрой" (ИНН 5401234568, ОГРН 1025400012345), '
        "именуемое в дальнейшем «Подрядчик», в лице директора "
        "Белова Дмитрия Николаевича, паспорт серия 50 04 номер 567890, "
        "действующего на основании Устава, с одной стороны, и"
    )
    _add_paragraph(doc,
        'МУП "Горводоканал" (ИНН 5407654322, ОГРН 1035401012345), '
        "именуемое в дальнейшем «Заказчик», в лице начальника "
        "Тихоновой Елены Павловны, действующей на основании приказа № 112, "
        "с другой стороны,"
    )
    _add_paragraph(doc,
        "заключили настоящее дополнительное соглашение о нижеследующем:"
    )
    _add_paragraph(doc, "")
    _add_paragraph(doc,
        "1. Стороны договорились изменить сроки выполнения работ по прокладке "
        "водопровода по ул. Кирова, д. 10-25."
    )
    _add_paragraph(doc,
        "2. Новый срок начала работ: 1 декабря 2025 г."
    )
    _add_paragraph(doc,
        "3. Новый срок окончания работ: 1 марта 2025 г."
    )
    _add_paragraph(doc,
        "4. Стоимость работ по настоящему соглашению составляет "
        "300 000 (триста тысяч) рублей 00 копеек."
    )
    _add_paragraph(doc,
        "5. Все остальные условия Договора остаются без изменений."
    )
    _add_paragraph(doc, "")
    _add_paragraph(doc, "Подрядчик: ________________ / Белов Д.Н. /")
    _add_paragraph(doc, "Заказчик:  ________________ / Тихонова Е.П. /")

    doc.save(OUTPUT_DIR / "допсоглашение_даты_назад.docx")


def create_contract_huge_amount() -> None:
    """Договор подряда — АНОМАЛИЯ L2: сумма 15 млрд руб."""
    doc = Document()
    doc.add_heading("ДОГОВОР ПОДРЯДА № 001/2024", level=1)

    _add_paragraph(doc, "г. Санкт-Петербург                                            10 сентября 2024 г.")
    _add_paragraph(doc, "")
    _add_paragraph(doc,
        'ЗАО "МегаСтрой" (ИНН 7810234567, ОГРН 1037810012345), '
        "именуемое в дальнейшем «Подрядчик», в лице генерального директора "
        "Орлова Сергея Петровича, паспорт серия 40 18 номер 234567, "
        "действующего на основании Устава, с одной стороны, и"
    )
    _add_paragraph(doc,
        'ГУП "Метрострой Северо-Запад" (ИНН 7802345678, ОГРН 1027800012345), '
        "именуемое в дальнейшем «Заказчик», в лице директора "
        "Николаевой Ольги Андреевны, действующей на основании Устава, "
        "с другой стороны,"
    )
    _add_paragraph(doc,
        "заключили настоящий Договор о нижеследующем:"
    )
    _add_paragraph(doc, "")
    _add_paragraph(doc,
        "1. ПРЕДМЕТ ДОГОВОРА", bold=True,
    )
    _add_paragraph(doc,
        "1.1. Подрядчик обязуется выполнить строительно-монтажные работы по возведению "
        "жилого комплекса «Северная Звезда» на земельном участке по адресу: "
        "г. Санкт-Петербург, Приморский район, ул. Новая, уч. 15."
    )
    _add_paragraph(doc, "")
    _add_paragraph(doc,
        "2. СТОИМОСТЬ РАБОТ", bold=True,
    )
    _add_paragraph(doc,
        "2.1. Общая стоимость работ по настоящему Договору составляет "
        "15 000 000 000 (пятнадцать миллиардов) рублей 00 копеек, в том числе НДС 20%."
    )
    _add_paragraph(doc, "")
    _add_paragraph(doc,
        "3. СРОКИ ВЫПОЛНЕНИЯ РАБОТ", bold=True,
    )
    _add_paragraph(doc,
        "3.1. Начало работ: 1 октября 2024 г."
    )
    _add_paragraph(doc,
        "3.2. Окончание работ: 30 сентября 2027 г."
    )
    _add_paragraph(doc, "")
    _add_paragraph(doc,
        "4. Оплата производится поэтапно на основании актов выполненных работ."
    )
    _add_paragraph(doc, "")
    _add_paragraph(doc, "Реквизиты сторон:", bold=True)
    _add_paragraph(doc,
        'Подрядчик: ЗАО "МегаСтрой", р/с 40702810300000011111 '
        "в ПАО Сбербанк, БИК 044030653. "
        "Тел: +7 (812) 345-67-89, email: info@megastroy.ru"
    )
    _add_paragraph(doc,
        'Заказчик: ГУП "Метрострой Северо-Запад", р/с 40502810200000022222 '
        "в Банк ГПБ (АО), БИК 044030827."
    )
    _add_paragraph(doc, "")
    _add_paragraph(doc, "Подрядчик: ________________ / Орлов С.П. /")
    _add_paragraph(doc, "Заказчик:  ________________ / Николаева О.А. /")

    doc.save(OUTPUT_DIR / "подряд_огромная_сумма.docx")


def create_agency_duplicate() -> None:
    """Агентский договор — АНОМАЛИЯ L4: дубликат акта (контрагент+дата+сумма)."""
    doc = Document()
    doc.add_heading("АГЕНТСКИЙ ДОГОВОР № 88/2025", level=1)

    _add_paragraph(doc, "г. Москва                                                    20 января 2025 г.")
    _add_paragraph(doc, "")
    _add_paragraph(doc,
        'ООО "ПромСервис" (ИНН 7723456789, ОГРН 1157746012345), '
        "именуемое в дальнейшем «Принципал», в лице генерального директора "
        "Фёдорова Алексея Викторовича, действующего на основании Устава, "
        "с одной стороны, и"
    )
    _add_paragraph(doc,
        'ООО "Агент-Про" (ИНН 7712345679, ОГРН 1197746099999), '
        "именуемое в дальнейшем «Агент», в лице директора "
        "Захаровой Натальи Олеговны, паспорт серия 45 19 номер 112233, "
        "действующей на основании Устава, с другой стороны,"
    )
    _add_paragraph(doc,
        "заключили настоящий Договор о нижеследующем:"
    )
    _add_paragraph(doc, "")
    _add_paragraph(doc,
        "1. Агент обязуется по поручению Принципала совершать юридические и "
        "фактические действия по поиску клиентов для технического обслуживания "
        "серверного оборудования."
    )
    _add_paragraph(doc,
        "2. Вознаграждение Агента составляет 450 000 (четыреста пятьдесят тысяч) "
        "рублей за отчётный период."
    )
    _add_paragraph(doc,
        "3. Срок действия: с 20 января 2025 г. по 31 декабря 2025 г."
    )
    _add_paragraph(doc, "")
    _add_paragraph(doc, "Принципал: ________________ / Фёдоров А.В. /")
    _add_paragraph(doc, "Агент:     ________________ / Захарова Н.О. /")

    doc.save(OUTPUT_DIR / "агентский_дубликат.docx")


def create_license_same_dates() -> None:
    """Лицензионный договор — АНОМАЛИЯ L3: все 3 даты одинаковые."""
    doc = Document()
    doc.add_heading("ЛИЦЕНЗИОННЫЙ ДОГОВОР № 12-Л/2025", level=1)

    _add_paragraph(doc, "г. Казань                                                     1 марта 2025 г.")
    _add_paragraph(doc, "")
    _add_paragraph(doc,
        'ООО "СофтЛайн" (ИНН 1655234567, ОГРН 1161690012346), '
        "именуемое в дальнейшем «Лицензиар», в лице генерального директора "
        "Гарифуллина Рината Маратовича, действующего на основании Устава, "
        "с одной стороны, и"
    )
    _add_paragraph(doc,
        'ООО "Цифровые Решения" (ИНН 1657654321, ОГРН 1191690054321), '
        "именуемое в дальнейшем «Лицензиат», в лице директора "
        "Сафиной Альбины Ильдаровны, паспорт серия 92 20 номер 345678, "
        "действующей на основании Устава, с другой стороны,"
    )
    _add_paragraph(doc,
        "заключили настоящий Договор о нижеследующем:"
    )
    _add_paragraph(doc, "")
    _add_paragraph(doc,
        "1. Лицензиар предоставляет Лицензиату неисключительную лицензию на "
        "использование программного обеспечения «СофтЛайн.ERP» версии 4.0."
    )
    _add_paragraph(doc,
        "2. Лицензионное вознаграждение составляет 120 000 (сто двадцать тысяч) "
        "рублей в месяц."
    )
    _add_paragraph(doc,
        "3. Дата начала действия лицензии: 1 марта 2025 г."
    )
    _add_paragraph(doc,
        "4. Дата окончания действия лицензии: 1 марта 2025 г."
    )
    _add_paragraph(doc,
        "5. Территория использования: Российская Федерация."
    )
    _add_paragraph(doc, "")
    _add_paragraph(doc, "Реквизиты:", bold=True)
    _add_paragraph(doc,
        'Лицензиар: ООО "СофтЛайн", р/с 40702810400000077777 '
        "в ПАО АК БАРС БАНК, БИК 049205805."
    )
    _add_paragraph(doc, "")
    _add_paragraph(doc, "Лицензиар:  ________________ / Гарифуллин Р.М. /")
    _add_paragraph(doc, "Лицензиат:  ________________ / Сафина А.И. /")

    doc.save(OUTPUT_DIR / "лицензионный_копипаст_дат.docx")


def create_guarantee_letter() -> None:
    """Гарантийное письмо — нормальный документ без суммы."""
    doc = Document()
    doc.add_heading("ГАРАНТИЙНОЕ ПИСЬМО", level=1)

    _add_paragraph(doc, "Исх. № 42-ГП от 15 февраля 2025 г.")
    _add_paragraph(doc, "")
    _add_paragraph(doc,
        'Генеральному директору ООО "СтройИнвест"'
    )
    _add_paragraph(doc, "Хамитову Р.Ф.")
    _add_paragraph(doc, "")
    _add_paragraph(doc,
        'АО "Банк Развития" (ИНН 7707234567, ОГРН 1027700132100), '
        "в лице заместителя председателя правления Кузнецова Михаила Ивановича, "
        "настоящим гарантирует исполнение обязательств по оплате строительных "
        "материалов, поставляемых в адрес нашего клиента — "
        'ООО "Домострой" (ИНН 7715234567).'
    )
    _add_paragraph(doc, "")
    _add_paragraph(doc,
        "В случае неоплаты поставленных материалов в течение 30 (тридцати) "
        "календарных дней с даты поставки, АО «Банк Развития» обязуется произвести "
        "оплату в полном объёме за счёт собственных средств."
    )
    _add_paragraph(doc, "")
    _add_paragraph(doc,
        "Настоящее гарантийное письмо действует до 31 декабря 2025 г."
    )
    _add_paragraph(doc, "")
    _add_paragraph(doc, "Реквизиты гаранта:", bold=True)
    _add_paragraph(doc,
        'АО "Банк Развития", р/с 30101810100000000456 '
        "в ЦБ РФ, БИК 044525456. "
        "Адрес: г. Москва, ул. Воздвиженка, д. 8/1. "
        "Тел: +7 (495) 777-88-99, email: garantee@bankdev.ru"
    )
    _add_paragraph(doc, "")
    _add_paragraph(doc, "Зам. председателя правления ________________ / Кузнецов М.И. /")
    _add_paragraph(doc, "М.П.")

    doc.save(OUTPUT_DIR / "гарантийное_письмо.docx")


def create_power_of_attorney_bad_ocr() -> None:
    """Доверенность — имитация плохого OCR (побуквенный текст)."""
    doc = Document()
    doc.add_heading("Д О В Е Р Е Н Н О С Т Ь", level=1)

    _add_paragraph(doc, "г .  М о с к в а                                    д е с я т о е   я н в а р я   2 0 2 5   г .")
    _add_paragraph(doc, "")
    _add_paragraph(doc,
        'О О О  " Т е х Н о в а "  ( И Н Н  7 7 0 1 2 3 4 5 6 9 ,  '
        'О Г Р Н  1 0 2 7 7 0 0 1 3 2 1 9 6 ) ,  в  л и ц е  г е н е р а л ь н о г о '
        '  д и р е к т о р а  С е м ё н о в а  И г о р я  А л е к с е е в и ч а ,'
        '  д е й с т в у ю щ е г о  н а  о с н о в а н и и  У с т а в а ,'
    )
    _add_paragraph(doc, "")
    _add_paragraph(doc,
        "настоящей доверенностью уполномочивает:"
    )
    _add_paragraph(doc, "")
    _add_paragraph(doc,
        "К у з ь м и н у  А н н у  П е т р о в н у,  паспорт серия 45 17 номер 890123, "
        "выдан УФМС России по г. Москве 20.05.2017,"
    )
    _add_paragraph(doc, "")
    _add_paragraph(doc,
        "представлять интересы Общества во всех государственных органах, "
        "учреждениях и организациях, подписывать документы, подавать и получать "
        "любые документы, связанные с деятельностью Общества."
    )
    _add_paragraph(doc, "")
    _add_paragraph(doc,
        "Доверенность выдана сроком на один год без права передоверия."
    )
    _add_paragraph(doc,
        "Дата выдачи: 10 января 2025 г. Срок действия: до 10 января 2026 г."
    )
    _add_paragraph(doc, "")
    _add_paragraph(doc, "Генеральный директор ________________ / Семёнов И.А. /")
    _add_paragraph(doc, "М.П.")

    doc.save(OUTPUT_DIR / "доверенность_плохой_текст.docx")


def main() -> None:
    OUTPUT_DIR.mkdir(parents=True, exist_ok=True)

    generators = [
        ("акт_выполненных_работ.docx", create_act),
        ("счёт_без_суммы.docx", create_invoice_no_amount),
        ("допсоглашение_даты_назад.docx", create_addendum_dates_reversed),
        ("подряд_огромная_сумма.docx", create_contract_huge_amount),
        ("агентский_дубликат.docx", create_agency_duplicate),
        ("лицензионный_копипаст_дат.docx", create_license_same_dates),
        ("гарантийное_письмо.docx", create_guarantee_letter),
        ("доверенность_плохой_текст.docx", create_power_of_attorney_bad_ocr),
    ]

    for name, func in generators:
        func()
        print(f"  {name}")

    total = sum(1 for f in OUTPUT_DIR.glob("*") if f.suffix.lower() in (".pdf", ".docx"))
    print(f"\nИтого тестовых файлов: {total}")


if __name__ == "__main__":
    main()
